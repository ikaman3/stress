<!DOCTYPE html>
<html>
<head>
    <title>이미지 게시판</title>
</head>
<body>
    <h1>이미지 게시판</h1>

    <form id="post-form">
        <textarea id="post-content" rows="4" cols="50" placeholder="글 내용을 입력하세요"></textarea>
        <button type="button" id="add-image-button">사진 추가</button>
        <input type="file" id="image-upload" accept="image/*" style="display: none;">
        <button type="button" id="submit-button">게시하기</button>
    </form>

    <div id="posts">
        <!-- 여기에 게시된 글과 이미지가 표시될 공간입니다. -->
    </div>

    <script>
        const postForm = document.getElementById("post-form");
        const postContent = document.getElementById("post-content");
        const addImageButton = document.getElementById("add-image-button");
        const imageUpload = document.getElementById("image-upload");
        const submitButton = document.getElementById("submit-button");
        const posts = document.getElementById("posts");

        addImageButton.addEventListener("click", function () {
            imageUpload.click();
        });

        imageUpload.addEventListener("change", function () {
            const selectedImage = imageUpload.files[0];
            const content = postContent.value;
            const imgElement = document.createElement("img");
            imgElement.src = URL.createObjectURL(selectedImage);

            // 이미지를 커서 위치에 삽입
            if (content && typeof postContent.selectionStart !== "undefined") {
                const startPos = postContent.selectionStart;
                const endPos = postContent.selectionEnd;

                const beforeText = content.substring(0, startPos);
                const afterText = content.substring(endPos, content.length);

                postContent.value = beforeText + `\n![Image](${imgElement.src})\n` + afterText;
            } else {
                // 커서 위치를 알 수 없는 경우 마지막에 삽입
                postContent.value = content + `\n![Image](${imgElement.src})`;
            }
        });

        submitButton.addEventListener("click", function () {
            const content = postContent.value;

            if (content.trim() === "") {
                alert("글 내용을 입력하세요.");
                return;
            }

            const postDiv = document.createElement("div");
            postDiv.innerHTML = `<p>${content}</p>`;
            posts.appendChild(postDiv);

            // 게시 후 입력 필드 초기화
            postContent.value = "";
            imageUpload.value = "";
        });
    </script>
</body>
</html>
